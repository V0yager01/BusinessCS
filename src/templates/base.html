<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ title or "Система управления бизнесом" }}</title>
    <link rel="stylesheet" href="{{ url_for('static', path='/style.css') }}">
</head>
<body>
    <header>
        <h1>Система управления бизнесом</h1>
        <nav id="navMenu">
            <a href="/">Главная</a>
            <a href="/login" id="loginLink">Вход</a>
            <a href="/register" id="registerLink">Регистрация</a>
            <a href="/teams" id="teamsLink" style="display: none;">Команды</a>
            <a href="/tasks" id="tasksLink" style="display: none;">Задачи</a>
            <a href="/meetings" id="meetingsLink" style="display: none;">Встречи</a>
            <a href="/calendar" id="calendarLink" style="display: none;">Календарь</a>
            <a href="/evaluations" id="evaluationsLink" style="display: none;">Оценки</a>
            <a href="/profile" id="profileLink" style="display: none;">Профиль</a>
            <a href="#" id="logoutLink" style="display: none;">Выход</a>
        </nav>
    </header>

    <main>
        {% block content %}
        {% endblock %}
    </main>

    <footer>
        <p>© 2025 BusinessManager</p>
    </footer>

    <script src="{{ url_for('static', path='/api.js') }}"></script>
    <script>
    (function() {
    const token = localStorage.getItem('access_token');
    const loginLink = document.getElementById('loginLink');
    const registerLink = document.getElementById('registerLink');
    const teamsLink = document.getElementById('teamsLink');
        const tasksLink = document.getElementById('tasksLink');
        const meetingsLink = document.getElementById('meetingsLink');
        const calendarLink = document.getElementById('calendarLink');
        const evaluationsLink = document.getElementById('evaluationsLink');
    const profileLink = document.getElementById('profileLink');
    const logoutLink = document.getElementById('logoutLink');

    if (token) {
            if (loginLink) loginLink.style.display = 'none';
            if (registerLink) registerLink.style.display = 'none';
            if (teamsLink) teamsLink.style.display = 'inline';
            if (tasksLink) tasksLink.style.display = 'inline';
            if (meetingsLink) meetingsLink.style.display = 'inline';
            if (calendarLink) calendarLink.style.display = 'inline';
            if (evaluationsLink) evaluationsLink.style.display = 'inline';
            if (profileLink) {
        profileLink.style.display = 'inline';
                profileLink.href = '/profile';
            }
            if (logoutLink) logoutLink.style.display = 'inline';
    } else {
            if (loginLink) loginLink.style.display = 'inline';
            if (registerLink) registerLink.style.display = 'inline';
            if (teamsLink) teamsLink.style.display = 'none';
            if (tasksLink) tasksLink.style.display = 'none';
            if (meetingsLink) meetingsLink.style.display = 'none';
            if (calendarLink) calendarLink.style.display = 'none';
            if (evaluationsLink) evaluationsLink.style.display = 'none';
            if (profileLink) profileLink.style.display = 'none';
            if (logoutLink) logoutLink.style.display = 'none';
    }

        if (logoutLink) {
            logoutLink.addEventListener('click', (e) => {
        e.preventDefault();
        localStorage.removeItem('access_token');
        window.location.href = '/';
    });
        }
    })();
    </script>
    {% block scripts %}
    {% endblock %}
</body>
</html>
